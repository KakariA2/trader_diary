<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–î–Ω–µ–≤–Ω–∏–∫ —Ç—Ä–µ–π–¥–µ—Ä–∞</title>

  <!-- –®—Ä–∏—Ñ—Ç -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3753146282257487" crossorigin="anonymous"></script>
</head>

<body>

  <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –≤—Ä–µ–º–µ–Ω–µ–º –∏ –ª–æ–≥–∏–Ω–æ–º -->
  <table style="width: 100%; padding: 10px;">
    <tr>
      <td>
        <p id="datetime"></p>
        <script>
          function updateDateTime() {
              const now = new Date();
              const options = { weekday: 'long', year: 'numeric', month: '2-digit', day: '2-digit' };
              const date = now.toLocaleDateString('ru-RU', options);
              const time = now.toLocaleTimeString('ru-RU');
              document.getElementById("datetime").innerHTML = `–°–µ–≥–æ–¥–Ω—è: ${date}<br>–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: ${time}`;
          }
          setInterval(updateDateTime, 1000);
          updateDateTime();
        </script>
      </td>
      <td style="text-align: right;">
        {% if session.get('username') %}
          <p>–ü—Ä–∏–≤–µ—Ç, {{ session['username'] }}!
            <a href="{{ url_for('logout') }}">üîí –í—ã–π—Ç–∏</a>
          </p>
        {% else %}
          <p>
            <a href="{{ url_for('login') }}">–í—Ö–æ–¥</a> |
            <a href="{{ url_for('register') }}">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
          </p>
        {% endif %}
      </td>
    </tr>
  </table>

  <div class="container">
    <h1>–î–Ω–µ–≤–Ω–∏–∫ —Ç—Ä–µ–π–¥–µ—Ä–∞</h1>

    <div style="margin-top: 20px;">
      <h3>{{ texts['total_profit'] }}:
        <span style="color: {{ 'green' if total_profit >= 0 else 'red' }}">{{ total_profit }}</span>
      </h3>

      <h4>{{ texts['profit_by_pair'] }}:</h4>
      <ul>
        {% for pair, profit in profit_by_pair.items() %}
          <li>{{ pair }}:
            <span style="color: {{ 'green' if profit >= 0 else 'red' }}">{{ profit }}</span>
          </li>
        {% endfor %}
      </ul>
    </div>

    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–¥–µ–ª–∫–∏ -->
    <form action="/add" method="POST">
      <input type="text" name="pair" placeholder="–ü–∞—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, EUR/USD)" required>
      <input type="datetime-local" name="date" required>
      <select name="type">
        <option value="Buy">–ö—É–ø–∏—Ç—å</option>
        <option value="Sell">–ü—Ä–æ–¥–∞—Ç—å</option>
      </select>
      <input type="number" name="lot" step="0.01" placeholder="–õ–æ—Ç" required>
      <input type="number" name="profit" step="0.01" placeholder="–ü—Ä–∏–±—ã–ª—å/–£–±—ã—Ç–æ–∫" required>
      <input type="text" name="comment" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π">
      <button type="submit">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </form>

    <hr>

    <!-- –§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ -->
    <form action="/" method="get" style="text-align: center; margin-bottom: 20px;">
      <label for="year" style="font-weight: bold; margin-right: 10px;">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ–¥ –∏ –º–µ—Å—è—Ü:</label>
      <select name="year" id="year" style="padding: 6px 10px; font-size: 16px; margin-right: 10px; border-radius: 5px; border: 1px solid #ccc;">
        {% for y in years %}
          <option value="{{ y }}" {% if y == selected_year %}selected{% endif %}>{{ y }}</option>
        {% endfor %}
      </select>
      <select name="month" id="month" style="padding: 6px 10px; font-size: 16px; border-radius: 5px; border: 1px solid #ccc;">
        {% for m in months %}
          <option value="{{ m[0] }}" {% if m[0] == selected_month %}selected{% endif %}>{{ m[1] }}</option>
        {% endfor %}
      </select>
      <button type="submit" style="padding: 8px 16px; font-size: 16px; margin-left: 15px; border-radius: 5px; background-color: #4CAF50; color: white; border: none; cursor: pointer;">–ü–æ–∫–∞–∑–∞—Ç—å</button>
    </form>

    <hr>

    <!-- –¢–∞–±–ª–∏—Ü–∞ —Å–¥–µ–ª–æ–∫ -->
    <div class="table-wrapper">
      <table>
        <thead>
          <tr>
            <th>–ü–∞—Ä–∞</th>
            <th>–î–∞—Ç–∞</th>
            <th>–¢–∏–ø</th>
            <th>–õ–æ—Ç</th>
            <th>–ü—Ä–∏–±—ã–ª—å/–£–±—ã—Ç–æ–∫</th>
            <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
          </tr>
        </thead>
        <tbody>
          {% for trade in trades %}
          <tr>
            <td>{{ trade.pair }}</td>
            <td>{{ trade.date }}</td>
            <td>{{ trade.type }}</td>
            <td>{{ trade.lot }}</td>
            <td class="{{ 'positive' if trade.profit >= 0 else 'negative' }}">{{ trade.profit }}</td>
            <td>{{ trade.comment }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

  </div> <!-- –∫–æ–Ω–µ—Ü container -->

  <!-- Footer –≤—ã–Ω–µ—Å–µ–Ω –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ -->
  <footer class="support-box">
    <center>
      <div style="margin-bottom: 5px;">
        ‚òï <strong>–ü–æ–¥–¥–µ—Ä–∂–∏ –ø—Ä–æ–µ–∫—Ç:</strong>
        <a href="https://buymeacoffee.com/kakari" target="_blank">BuyMeACoffee</a> |
        <a href="https://yoomoney.ru/to/4100119196832465" target="_blank">–ÆMoney</a>
      </div>
    </center>

    <div style="margin-top: 8px; text-align: center;">
      <a href="/feedback" style="margin-right: 10px;">üì© –ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</a>
      <button id="shareBtn" style="
        padding: 8px 14px;
        font-size: 14px;
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
      ">
        üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å –¥—Ä—É–≥–æ–º
      </button>
    </div>
  </footer>

  <!-- –°–∫—Ä–∏–ø—Ç –ü–æ–¥–µ–ª–∏—Ç—å—Å—è -->
  <script>
    document.getElementById('shareBtn').addEventListener('click', async () => {
      if (navigator.share) {
        try {
          await navigator.share({
            title: '–î–Ω–µ–≤–Ω–∏–∫ —Ç—Ä–µ–π–¥–µ—Ä–∞',
            text: '–ü–æ–ø—Ä–æ–±—É–π —ç—Ç–æ—Ç –ø–æ–ª–µ–∑–Ω—ã–π –ø—Ä–æ–µ–∫—Ç: –î–Ω–µ–≤–Ω–∏–∫ —Ç—Ä–µ–π–¥–µ—Ä–∞ üìà',
            url: window.location.href
          });
        } catch (err) {
          console.log('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è:', err);
        }
      } else {
        alert('–§—É–Ω–∫—Ü–∏—è ¬´–ü–æ–¥–µ–ª–∏—Ç—å—Å—è¬ª –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è. –ü—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä—É–π —Å—Å—ã–ª–∫—É.');
      }
    });
  </script>

</body>
</html>
